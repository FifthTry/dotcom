-- import: www.fifthtry.com/dev/views
exposing: view, view-argument, validation


-- view: github-oidc
url: /ft-ep/views/github-oidc/
unimplemented: true

-- view.description:

This view will fetch the github repo details linked to the given site.

-- view.view-arguments:

	-- view-argument: site-slug
	
	-- view-argument.validations:
	
		-- validation: unknown-site
		error-message: There is no such site. Maybe the slug of the site has changed, or site has been deleted.
		status: done
		
		Check if site exists.
		
	-- end: view-argument.validations

-- end: view.view-arguments

-- view.other-validations:

	-- validation: not-org-member
	status: done
	
	Only people who have any role in the org can view the dashboard.
	
	-- validation: endpoint-per-add-domain-org-rate-limit-reached
	implement-in-future: true
	
	A single org will be allowed at max 2 requests per second to this endpoint.
	
	-- validation: global-rate-limit
	implement-in-future: true
	
	We only allow 100 requests per second to this endpoint.
	
-- end: view.other-validations

-- view.response:

\;; Expected = gh-oidc
\-- record gh-oidc:
string site-domain:
string site-slug:
string org-slug:
string account:           ;; Github organization
string repo:
string branch:
boolean is-configured:    ;; If site already has a linked github repo
string configure-url:     ;; Link to the configure github page
toc-data list header-links:

\-- record toc-data:
string name:
string full-name:
optional string link:
boolean is-active:
optional ftd.image-src icon:
toc-data list children:

-- end: view
